<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√¥ ph·ªèng Th√≠ nghi·ªám Rutherford</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
    </script>

    <style>
        body {
            background-color: #0f172a;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
        }
        canvas#simCanvas {
            background: radial-gradient(circle, #1e293b 0%, #0f172a 100%);
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            cursor: crosshair;
            width: 100%;
        }
        .control-panel {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
        }
        .stats-card {
            background: rgba(51, 65, 85, 0.5);
            border-left: 4px solid #f59e0b;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .active-tab {
            border-bottom: 2px solid #f59e0b;
            color: #f59e0b;
        }
        .model-3d-container {
            height: 350px;
            background: #0f172a;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            border: 1px solid #334155;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
        <header class="mb-6 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-yellow-500 mb-2">H·∫°t Nh√¢n & M√¥ H√¨nh Nguy√™n T·ª≠</h1>
            <div class="flex justify-center space-x-8 mt-4 border-b border-slate-700">
                <button onclick="switchTab('simulation')" id="tab-simulation" class="pb-2 font-semibold active-tab transition-all">M√¥ ph·ªèng th√≠ nghi·ªám</button>
                <button onclick="switchTab('knowledge')" id="tab-knowledge" class="pb-2 font-semibold text-slate-400 hover:text-white transition-all">Ki·∫øn th·ª©c b·ªï tr·ª£</button>
            </div>
        </header>

        <!-- TAB M√î PH·ªéNG -->
        <div id="simulation" class="tab-content active">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                <!-- Sidebar Controls -->
                <div class="lg:col-span-1 space-y-6">
                    <div class="control-panel p-6 rounded-xl border border-slate-700">
                        <h2 class="text-xl font-semibold mb-4 border-b border-slate-600 pb-2 text-blue-400">Thi·∫øt l·∫≠p</h2>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm mb-2">M√¥ h√¨nh nguy√™n t·ª≠:</label>
                                <select id="modelSelect" class="w-full bg-slate-800 border border-slate-600 rounded p-2 focus:ring-2 focus:ring-blue-500 outline-none">
                                    <option value="rutherford">M√¥ h√¨nh Rutherford (H·∫°t nh√¢n)</option>
                                    <option value="thomson">M√¥ h√¨nh Thomson (B√°nh m√¨ nho)</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm mb-2">T·ªëc ƒë·ªô h·∫°t alpha:</label>
                                <input type="range" id="speedRange" min="1" max="10" value="5" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-yellow-500">
                            </div>

                            <button id="toggleFire" class="w-full bg-red-600 hover:bg-red-500 text-white font-bold py-3 rounded-lg transition-colors shadow-lg active:scale-95">
                                B·∫ÆN H·∫†T ALPHA
                            </button>

                            <button id="clearBtn" class="w-full bg-slate-700 hover:bg-slate-600 text-white py-2 rounded-lg transition-colors">
                                X√≥a m√†n h√¨nh
                            </button>
                        </div>
                    </div>

                    <div class="stats-card p-4 rounded-lg shadow-md">
                        <h3 class="font-bold text-yellow-500 mb-2 text-sm uppercase">Th·ªëng k√™ (s·ªë h·∫°t):</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>T·ªïng:</span>
                                <span id="totalCount" class="font-mono">0</span>
                            </div>
                            <div class="flex justify-between text-green-400">
                                <span>Xuy√™n th·∫≥ng:</span>
                                <span id="straightCount" class="font-mono">0</span>
                            </div>
                            <div class="flex justify-between text-blue-400">
                                <span>L·ªách h∆∞·ªõng:</span>
                                <span id="deflectedCount" class="font-mono">0</span>
                            </div>
                            <div class="flex justify-between text-red-400">
                                <span>B·∫≠t ng∆∞·ª£c:</span>
                                <span id="backCount" class="font-mono">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Simulation View -->
                <div class="lg:col-span-3 relative">
                    <canvas id="simCanvas"></canvas>
                    
                    <div class="absolute bottom-4 left-4 right-4 flex justify-between items-end pointer-events-none">
                        <div class="bg-black/70 p-3 rounded text-xs text-white backdrop-blur">
                            <p class="flex items-center"><span class="w-3 h-3 bg-yellow-600 rounded-full mr-2"></span> Nguy√™n t·ª≠ v√†ng</p>
                            <p class="flex items-center mt-1"><span class="w-3 h-3 bg-green-500 rounded-full mr-2"></span> H·∫°t Alpha ($He^{2+}$)</p>
                        </div>
                        <div id="explanationBox" class="bg-slate-900/90 p-4 rounded-lg border border-yellow-500/50 max-w-xs text-sm italic shadow-2xl">
                            "Ph·∫ßn l·ªõn c√°c h·∫°t xuy√™n th·∫≥ng qua l√° v√†ng m·ªèng ch·ª©ng t·ªè nguy√™n t·ª≠ c√≥ c·∫•u t·∫°o r·ªóng."
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB KI·∫æN TH·ª®C B·ªî TR·ª¢ -->
        <div id="knowledge" class="tab-content">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Th√≠ nghi·ªám -->
                <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700">
                    <h3 class="text-xl font-bold text-yellow-500 mb-4 flex items-center">
                        <span class="mr-2">üî¨</span> Th√≠ nghi·ªám t√°n x·∫° h·∫°t Alpha
                    </h3>
                    <ul class="space-y-4 text-slate-300 text-sm">
                        <li><strong class="text-white">Thi·∫øt l·∫≠p:</strong> Ngu·ªìn ph√≥ng x·∫° b·∫Øn h·∫°t alpha v√†o l√° v√†ng m·ªèng (b·ªÅ d√†y ~1¬µm) trong bu·ªìng ch√¢n kh√¥ng.</li>
                        <li><strong class="text-white">K·∫øt qu·∫£:</strong>
                            <p class="mt-1 ml-4">‚Ä¢ Ph·∫ßn l·ªõn h·∫°t xuy√™n th·∫≥ng: Kh√¥ng gian nguy√™n t·ª≠ ch·ªß y·∫øu l√† r·ªóng.</p>
                            <p class="ml-4">‚Ä¢ M·ªôt s·ªë √≠t h·∫°t l·ªách h∆∞·ªõng (>1¬∞): ƒê·∫©y tƒ©nh ƒëi·ªán khi ƒëi g·∫ßn h·∫°t nh√¢n d∆∞∆°ng.</p>
                            <p class="ml-4">‚Ä¢ T·ªâ l·ªá c·ª±c nh·ªè (>90¬∞): Va ch·∫°m tr·ª±c di·ªán v·ªõi t√¢m t√≠ch ƒëi·ªán d∆∞∆°ng c·ª±c m·∫°nh.</p>
                        </li>
                    </ul>
                </div>

                <!-- C·∫•u t·∫°o & K√≠ch th∆∞·ªõc -->
                <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700">
                    <h3 class="text-xl font-bold text-blue-400 mb-4 flex items-center">
                        <span class="mr-2">‚öõÔ∏è</span> H·∫°t nh√¢n & K√≠ch th∆∞·ªõc
                    </h3>
                    <div class="space-y-4 text-slate-300 text-sm">
                        <div>
                            <p class="text-white font-semibold">C·∫•u t·∫°o h·∫°t nh√¢n (Nucleon):</p>
                            <p>‚Ä¢ <strong>Proton (p):</strong> $q = +e, m \approx 1,673 \cdot 10^{-27} kg$</p>
                            <p>‚Ä¢ <strong>Neutron (n):</strong> $q = 0, m \approx 1,675 \cdot 10^{-27} kg$</p>
                        </div>
                        <div>
                            <p class="text-white font-semibold">K√≠ch th∆∞·ªõc:</p>
                            <p>B√°n k√≠nh h·∫°t nh√¢n: $r \approx 1,2 \cdot A^{1/3}$ (fm).</p>
                        </div>
                        <div class="p-3 bg-slate-900 rounded border border-slate-700">
                            <p class="text-center font-bold text-lg text-white font-serif italic">K√≠ hi·ªáu: ${}_{Z}^{A}X$</p>
                        </div>
                    </div>
                </div>

                <!-- SO S√ÅNH 3D M√î H√åNH -->
                <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700 md:col-span-2">
                    <div class="mb-6 border-b border-slate-700 pb-2">
                        <h4 class="text-2xl font-bold text-white">S·ª± ph√°t tri·ªÉn c√°c M√¥ h√¨nh Nguy√™n t·ª≠</h4>
                        <p class="text-sm text-slate-400 mt-1 italic">D√πng chu·ªôt ƒë·ªÉ xoay (Chu·ªôt tr√°i), thu ph√≥ng (Cu·ªôn), di chuy·ªÉn (Chu·ªôt ph·∫£i).</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <!-- Thompson -->
                        <div class="space-y-4">
                            <div class="p-4 bg-blue-900/20 border-l-4 border-blue-500 rounded">
                                <h5 class="font-bold text-blue-400 text-lg uppercase flex justify-between">
                                    M√¥ h√¨nh Thompson <span>1897</span>
                                </h5>
                                <p class="text-sm text-slate-300 mt-1">
                                    ƒê∆∞·ª£c v√≠ nh∆∞ <strong>"B√°nh m√¨ nho"</strong>. C√°c electron r·∫£i r√°c b√™n trong kh·ªëi c·∫ßu ƒëi·ªán d∆∞∆°ng.
                                </p>
                            </div>
                            <div id="thomson3d" class="model-3d-container"></div>
                        </div>

                        <!-- Rutherford -->
                        <div class="space-y-4">
                            <div class="p-4 bg-yellow-900/20 border-l-4 border-yellow-500 rounded">
                                <h5 class="font-bold text-yellow-500 text-lg uppercase flex justify-between">
                                    M√¥ h√¨nh Rutherford <span>1911</span>
                                </h5>
                                <p class="text-sm text-slate-300 mt-1">
                                    M√¥ h√¨nh <strong>"H√†nh tinh nguy√™n t·ª≠"</strong>. H·∫°t nh√¢n nh·ªè ·ªü trung t√¢m, electron quay xung quanh.
                                </p>
                            </div>
                            <div id="rutherford3d" class="model-3d-container"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
    </div>

    <script>
        // --- LOGIC TABS & SIMULATION ---
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const modelSelect = document.getElementById('modelSelect');
        const speedRange = document.getElementById('speedRange');
        const toggleFire = document.getElementById('toggleFire');
        const clearBtn = document.getElementById('clearBtn');

        const totalElem = document.getElementById('totalCount');
        const straightElem = document.getElementById('straightCount');
        const deflectedElem = document.getElementById('deflectedCount');
        const backElem = document.getElementById('backCount');

        let particles = [];
        let atoms = [];
        let isFiring = false;
        let stats = { total: 0, straight: 0, deflected: 0, back: 0 };

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('header button').forEach(btn => btn.classList.remove('active-tab', 'text-slate-400'));
            
            document.getElementById(tabId).classList.add('active');
            document.getElementById('tab-' + tabId).classList.add('active-tab');
            if (tabId === 'simulation') resize();
            if (tabId === 'knowledge') {
                setTimeout(init3D, 100);
            }
        }

        function resize() {
            if (document.getElementById('simulation').classList.contains('active')) {
                canvas.width = canvas.parentElement.clientWidth;
                canvas.height = 450;
                initAtoms();
            }
        }

        function initAtoms() {
            atoms = [];
            const rows = 4, cols = 5, spacing = 80;
            const startX = (canvas.width - (cols - 1) * spacing) / 2 + 50;
            const startY = (canvas.height - (rows - 1) * spacing) / 2;
            for (let i = 0; i < rows; i++) {
                for (let j = 0; j < cols; j++) {
                    atoms.push({ x: startX + j * spacing, y: startY + i * spacing, radius: 35, nucleusRadius: 4 });
                }
            }
        }

        class AlphaParticle {
            constructor() { this.reset(); }
            reset() {
                this.x = -20; this.y = Math.random() * canvas.height;
                this.vx = (Math.random() * 2 + 5) * (speedRange.value / 5);
                this.vy = (Math.random() - 0.5) * 0.2;
                this.history = []; this.active = true;
            }
            update() {
                if (!this.active) return;
                this.history.push({x: this.x, y: this.y});
                if (this.history.length > 20) this.history.shift();
                
                if (modelSelect.value === 'rutherford') {
                    atoms.forEach(atom => {
                        const dx = this.x - atom.x, dy = this.y - atom.y, distSq = dx*dx + dy*dy;
                        if (distSq < 5000) {
                            const force = 150 / (distSq + 20);
                            this.vx += (dx / Math.sqrt(distSq)) * force;
                            this.vy += (dy / Math.sqrt(distSq)) * force;
                        }
                    });
                } else { 
                    this.vy += (Math.random() - 0.5) * 0.05; 
                }

                this.x += this.vx; this.y += this.vy;
                if (this.x > canvas.width + 50 || this.x < -100 || this.y < -50 || this.y > canvas.height + 50) {
                    this.active = false; stats.total++;
                    if (this.vx < 0) stats.back++;
                    else if (Math.abs(this.vy) > 1.5) stats.deflected++;
                    else stats.straight++;
                    updateStatsDisplay();
                }
            }
            draw() {
                if (!this.active) return;
                ctx.beginPath(); ctx.strokeStyle = 'rgba(74, 222, 128, 0.3)'; ctx.lineWidth = 1;
                this.history.forEach((p, i) => i === 0 ? ctx.moveTo(p.x, p.y) : ctx.lineTo(p.x, p.y));
                ctx.stroke();
                ctx.beginPath(); ctx.arc(this.x, this.y, 3, 0, Math.PI * 2); ctx.fillStyle = '#4ade80'; ctx.fill();
            }
        }

        function updateStatsDisplay() {
            totalElem.innerText = stats.total; straightElem.innerText = stats.straight;
            deflectedElem.innerText = stats.deflected; backElem.innerText = stats.back;
        }

        function drawLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            atoms.forEach(atom => {
                const grad = ctx.createRadialGradient(atom.x, atom.y, 0, atom.x, atom.y, atom.radius);
                grad.addColorStop(0, 'rgba(245, 158, 11, 0.2)'); grad.addColorStop(1, 'rgba(245, 158, 11, 0)');
                ctx.beginPath(); ctx.arc(atom.x, atom.y, atom.radius, 0, Math.PI * 2); ctx.fillStyle = grad; ctx.fill();
                if (modelSelect.value === 'rutherford') {
                    ctx.beginPath(); ctx.arc(atom.x, atom.y, atom.nucleusRadius, 0, Math.PI * 2); ctx.fillStyle = '#f59e0b'; ctx.fill();
                }
            });
            if (isFiring && Math.random() < 0.5) particles.push(new AlphaParticle());
            particles.forEach((p, i) => { p.update(); p.draw(); if (!p.active && p.history.length === 0) particles.splice(i, 1); });
            requestAnimationFrame(drawLoop);
        }

        toggleFire.onclick = () => { isFiring = !isFiring; toggleFire.innerText = isFiring ? "D·ª™NG B·∫ÆN" : "B·∫ÆN H·∫†T ALPHA"; toggleFire.classList.toggle('bg-red-600'); toggleFire.classList.toggle('bg-green-600'); };
        clearBtn.onclick = () => { particles = []; stats = { total: 0, straight: 0, deflected: 0, back: 0 }; updateStatsDisplay(); };

        // --- LOGIC 3D ---
        let initialized3D = false;
        function init3D() {
            if (initialized3D) return;

            const createScene = (elementId, type) => {
                const container = document.getElementById(elementId);
                if (!container) return;
                
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(50, container.clientWidth / container.clientHeight, 0.1, 1000);
                const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                renderer.setSize(container.clientWidth, container.clientHeight);
                container.appendChild(renderer.domElement);

                const controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.enableZoom = true;

                // TƒÉng kho·∫£ng c√°ch camera ƒë·ªÉ m√¥ h√¨nh nh√¨n nh·ªè g·ªçn h∆°n
                camera.position.set(0, 1.2, 6.5);
                controls.update();

                if (type === 'thomson') {
                    // C·∫ßu ƒëi·ªán d∆∞∆°ng l·ªõn - B√°n k√≠nh 1.5
                    const sphereGeo = new THREE.SphereGeometry(1.5, 32, 32);
                    const sphereMat = new THREE.MeshPhongMaterial({ color: 0x3b82f6, transparent: true, opacity: 0.3, side: THREE.DoubleSide });
                    const sphere = new THREE.Mesh(sphereGeo, sphereMat);
                    scene.add(sphere);

                    for (let i = 0; i < 15; i++) {
                        const eGeo = new THREE.SphereGeometry(0.1, 16, 16);
                        const eMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
                        const e = new THREE.Mesh(eGeo, eMat);
                        const dist = Math.random() * 1.3;
                        const theta = Math.random() * Math.PI * 2;
                        const phi = Math.random() * Math.PI;
                        e.position.set(dist * Math.sin(phi) * Math.cos(theta), dist * Math.sin(phi) * Math.sin(theta), dist * Math.cos(phi));
                        scene.add(e);
                    }
                } else {
                    // H·∫°t nh√¢n Rutherford nh·ªè l·∫°i 80% (t·ª´ ~0.35 xu·ªëng 0.28)
                    const nucGeo = new THREE.SphereGeometry(0.28, 16, 16);
                    const nucMat = new THREE.MeshBasicMaterial({ color: 0xf59e0b });
                    const nucleus = new THREE.Mesh(nucGeo, nucMat);
                    scene.add(nucleus);

                    // C√°c qu·ªπ ƒë·∫°o h√†nh tinh nh·ªè l·∫°i 80%
                    const orbitGroup = new THREE.Group();
                    for (let i = 0; i < 4; i++) {
                        const radius = 1.6 + i * 0.32; // Gi·∫£m t·ª´ m·ª©c n·ªÅn 2.0 xu·ªëng 1.6
                        const orbitCircle = new THREE.Mesh(
                            new THREE.TorusGeometry(radius, 0.01, 16, 100),
                            new THREE.MeshBasicMaterial({ color: 0x64748b, transparent: true, opacity: 0.4 })
                        );
                        orbitCircle.rotation.x = Math.random() * Math.PI;
                        orbitCircle.rotation.y = Math.random() * Math.PI;
                        orbitGroup.add(orbitCircle);

                        const eGeo = new THREE.SphereGeometry(0.08, 16, 16);
                        const eMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
                        const e = new THREE.Mesh(eGeo, eMat);
                        e.userData = { angle: Math.random() * Math.PI * 2, speed: 0.02 + Math.random() * 0.02, radius, rotX: orbitCircle.rotation.x, rotY: orbitCircle.rotation.y };
                        orbitGroup.add(e);
                    }
                    scene.add(orbitGroup);
                    scene.userData.orbitGroup = orbitGroup;
                }

                scene.add(new THREE.AmbientLight(0xeeeeee));
                const pointLight = new THREE.PointLight(0xffffff, 1.2);
                pointLight.position.set(5, 5, 5);
                scene.add(pointLight);

                const animate = () => {
                    requestAnimationFrame(animate);
                    controls.update();
                    
                    if (type === 'rutherford' && scene.userData.orbitGroup) {
                        scene.userData.orbitGroup.children.forEach(child => {
                            if (child.userData.angle !== undefined) {
                                child.userData.angle += child.userData.speed;
                                const x = child.userData.radius * Math.cos(child.userData.angle);
                                const y = child.userData.radius * Math.sin(child.userData.angle);
                                child.position.set(x, y, 0);
                                child.position.applyEuler(new THREE.Euler(child.userData.rotX, child.userData.rotY, 0));
                            }
                        });
                    } else if (type === 'thomson') {
                        scene.rotation.y += 0.002;
                    }
                    
                    renderer.render(scene, camera);
                };
                animate();
            };

            createScene('thomson3d', 'thomson');
            createScene('rutherford3d', 'rutherford');
            initialized3D = true;
        }

        window.addEventListener('resize', resize);
        resize();
        drawLoop();
    </script>
</body>
</html>