<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mô phỏng Sóng Điện Từ 3D</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
    </script>

    <style>
        :root {
            --primary-color: #00d4ff;
            --e-color: #ff3333;
            --b-color: #00f2ff;
            --v-color: #ffff00;
            --bg-dark: #0a0a0a;
            --panel-bg: rgba(0, 0, 0, 0.85);
        }

        body { 
            margin: 0; 
            overflow: hidden; 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
            background-color: var(--bg-dark); 
            color: white; 
        }

        /* Tab System */
        #main-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        #tab-header {
            display: flex;
            background: #151515;
            border-bottom: 1px solid #333;
            z-index: 100;
        }

        .tab-btn {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            color: #888;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            outline: none;
        }

        .tab-btn.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background: rgba(0, 212, 255, 0.05);
        }

        .tab-content {
            display: none;
            flex: 1;
            position: relative;
        }

        .tab-content.active {
            display: block;
        }

        /* Simulation UI Elements */
        #ui-overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--panel-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--primary-color);
            backdrop-filter: blur(10px);
            user-select: none;
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
            max-width: 280px;
            z-index: 10;
        }

        h2 { margin-top: 0; color: var(--primary-color); font-size: 1.1rem; text-transform: uppercase; letter-spacing: 1px; }
        .control-group { margin-bottom: 12px; }
        label { display: block; margin-bottom: 5px; font-size: 0.85rem; color: #ccc; }
        input[type="range"] { width: 100%; cursor: pointer; accent-color: var(--primary-color); }
        
        .legend {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 0.8rem;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        .legend-item { display: flex; align-items: center; gap: 10px; }
        .color-box { width: 12px; height: 12px; border-radius: 2px; }

        /* Knowledge Tab Content */
        #knowledge-tab {
            overflow-y: auto;
            background: #0f0f0f;
            padding: 40px 20px;
        }

        .article {
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
            color: #ddd;
        }

        .article h1 { color: var(--primary-color); border-bottom: 1px solid #333; padding-bottom: 10px; }
        .article h3 { color: #eee; margin-top: 30px; }
        .article p { margin-bottom: 15px; }
        .article ul { margin-bottom: 20px; }
        .article li { margin-bottom: 8px; }
        
        .highlight-box {
            background: rgba(0, 212, 255, 0.1);
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }

        code {
            background: #222;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: monospace;
            color: #ffcc00;
        }

        #canvas-container {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>

    <div id="main-container">
        <!-- Header với các Tab -->
        <div id="tab-header">
            <button class="tab-btn active" onclick="switchTab('sim')">Mô phỏng 3D</button>
            <button class="tab-btn" onclick="switchTab('knowledge')">Kiến thức Sóng Điện Từ</button>
        </div>

        <!-- Tab 1: Mô phỏng -->
        <div id="sim-tab" class="tab-content active">
            <div id="ui-overlay">
                <h2>Điều khiển Sóng</h2>
                <div class="control-group">
                    <label id="freq-label">Tần số: 1.0</label>
                    <input type="range" id="frequency" min="0.1" max="3" step="0.1" value="1">
                </div>
                <div class="control-group">
                    <label id="amp-label">Biên độ: 2.0</label>
                    <input type="range" id="amplitude" min="0.5" max="4" step="0.1" value="2">
                </div>
                <div class="control-group">
                    <label id="speed-label">Tốc độ truyền: 2.0</label>
                    <input type="range" id="speed" min="0.5" max="5" step="0.1" value="2">
                </div>

                <div class="legend">
                    <div class="legend-item"><div class="color-box" style="background:var(--e-color)"></div> Điện trường (E)</div>
                    <div class="legend-item"><div class="color-box" style="background:var(--b-color)"></div> Từ trường (B)</div>
                    <div class="legend-item"><div class="color-box" style="background:var(--v-color)"></div> Phương truyền (v)</div>
                </div>
            </div>
            <div id="canvas-container"></div>
        </div>

        <!-- Tab 2: Kiến thức -->
        <div id="knowledge-tab" class="tab-content">
            <div class="article">
                <h1>Kiến thức về Sóng Điện Từ</h1>
                
                <p>Sóng điện từ là sự lan truyền của dao động điện từ trường trong không gian. Khác với sóng cơ học, sóng điện từ không cần môi trường vật chất để lan truyền; chúng có thể truyền đi trong chân không với tốc độ ánh sáng.</p>

                <div class="highlight-box">
                    <strong>Định nghĩa cốt lõi:</strong> Sóng điện từ là sóng ngang, bao gồm các thành phần điện trường ($\vec{E}$) và từ trường ($\vec{B}$) dao động vuông góc với nhau và vuông góc với phương truyền sóng ($\vec{v}$).
                </div>

                <h3>1. Các đặc điểm chính</h3>
                <ul>
                    <li><strong>Tính chất sóng ngang:</strong> Tại mọi điểm, véc-tơ $\vec{E}$ và $\vec{B}$ luôn vuông góc với nhau và vuông góc với phương truyền. Chúng tạo thành một tam diện thuận.</li>
                    <li><strong>Sự cùng pha:</strong> Điện trường và từ trường luôn biến thiên cùng pha. Khi cường độ điện trường đạt cực đại thì cảm ứng từ cũng đạt cực đại.</li>
                    <li><strong>Tốc độ lan truyền:</strong> Trong chân không, sóng điện từ lan truyền với vận tốc $c \approx 3.10^8$ m/s.</li>
                    <li><strong>Năng lượng:</strong> Sóng điện từ mang năng lượng. Năng lượng này tỉ lệ với lũy thừa bậc 4 của tần số (theo một số mô hình lý thuyết).</li>
                </ul>

                <h3>2. Công thức cơ bản</h3>
                <p>Mối quan hệ giữa tốc độ ($v$), bước sóng ($\lambda$) và tần số ($f$):</p>
                <p style="text-align: center; font-size: 1.2rem; background: #222; padding: 10px; border-radius: 8px;">
                    $v = \lambda \cdot f$
                </p>

                <h3>3. Thang sóng điện từ</h3>
                <p>Dựa vào tần số hoặc bước sóng, sóng điện từ được phân loại thành:</p>
                <ul>
                    <li><strong>Sóng vô tuyến:</strong> Dùng trong thông tin liên lạc.</li>
                    <li><strong>Tia hồng ngoại:</strong> Bức xạ nhiệt.</li>
                    <li><strong>Ánh sáng nhìn thấy:</strong> Từ đỏ đến tím (0.38µm - 0.76µm).</li>
                    <li><strong>Tia tử ngoại, Tia X, Tia Gamma:</strong> Sóng có năng lượng cao, có khả năng đâm xuyên mạnh.</li>
                </ul>

                <h3>4. Ứng dụng</h3>
                <p>Sóng điện từ là nền tảng của công nghệ hiện đại, từ WiFi, điện thoại di động, truyền hình vệ tinh cho đến các thiết bị y tế như máy chụp X-quang và phương pháp điều trị ung thư bằng tia xạ.</p>
            </div>
        </div>
    </div>

    <script>
        // --- Logic Chuyển Tab ---
        function switchTab(tabId) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tabId === 'sim') {
                document.querySelector('.tab-btn:nth-child(1)').classList.add('active');
                document.getElementById('sim-tab').classList.add('active');
                onWindowResize(); // Cập nhật lại kích thước canvas
            } else {
                document.querySelector('.tab-btn:nth-child(2)').classList.add('active');
                document.getElementById('knowledge-tab').classList.add('active');
            }
        }

        // --- Logic Mô phỏng Three.js ---
        let scene, camera, renderer, controls;
        let eLine, bLine, waveArrows = [];
        let time = 0;
        
        const params = {
            frequency: 1.0,
            amplitude: 2.0,
            speed: 2.0,
            pointsCount: 400,
            length: 25
        };

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(15, 10, 15);

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight - 50); // Trừ đi chiều cao tab header
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('canvas-container').appendChild(renderer.domElement);

            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;

            const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
            scene.add(ambientLight);
            const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
            dirLight.position.set(5, 10, 7);
            scene.add(dirLight);

            const gridHelper = new THREE.GridHelper(50, 50, 0x222222, 0x111111);
            gridHelper.position.y = -5;
            scene.add(gridHelper);

            // Trục X (Vàng)
            const arrowX = new THREE.ArrowHelper(new THREE.Vector3(1, 0, 0), new THREE.Vector3(0, 0, 0), params.length + 3, 0xffff00, 0.8, 0.4);
            scene.add(arrowX);

            eLine = new THREE.Line(new THREE.BufferGeometry(), new THREE.LineBasicMaterial({ color: 0xff3333, linewidth: 3 }));
            bLine = new THREE.Line(new THREE.BufferGeometry(), new THREE.LineBasicMaterial({ color: 0x00f2ff, linewidth: 3 }));
            scene.add(eLine, bLine);

            // Listeners
            document.getElementById('frequency').oninput = function() { params.frequency = parseFloat(this.value); document.getElementById('freq-label').innerText = `Tần số: ${this.value}`; };
            document.getElementById('amplitude').oninput = function() { params.amplitude = parseFloat(this.value); document.getElementById('amp-label').innerText = `Biên độ: ${this.value}`; };
            document.getElementById('speed').oninput = function() { params.speed = parseFloat(this.value); document.getElementById('speed-label').innerText = `Tốc độ truyền: ${this.value}`; };

            window.addEventListener('resize', onWindowResize, false);
            animate();
        }

        function onWindowResize() {
            const container = document.getElementById('sim-tab');
            if (!container.classList.contains('active')) return;
            
            const w = window.innerWidth;
            const h = window.innerHeight - 50;
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
            renderer.setSize(w, h);
        }

        function updateWaves() {
            const ePoints = [], bPoints = [];
            while(waveArrows.length > 0) scene.remove(waveArrows.pop());

            const stepSize = params.length / params.pointsCount;
            const arrowInterval = 14;

            for (let i = 0; i <= params.pointsCount; i++) {
                const x = i * stepSize;
                const phase = (x * params.frequency * 0.6) - (time * params.speed);
                const val = Math.sin(phase) * params.amplitude;

                ePoints.push(new THREE.Vector3(x, val, 0));
                bPoints.push(new THREE.Vector3(x, 0, val));

                if (i % arrowInterval === 0 && Math.abs(val) > 0.15) {
                    const eArr = new THREE.ArrowHelper(new THREE.Vector3(0, val > 0 ? 1 : -1, 0), new THREE.Vector3(x, 0, 0), Math.abs(val), 0xff3333, 0.3, 0.2);
                    const bArr = new THREE.ArrowHelper(new THREE.Vector3(0, 0, val > 0 ? 1 : -1), new THREE.Vector3(x, 0, 0), Math.abs(val), 0x00f2ff, 0.3, 0.2);
                    scene.add(eArr, bArr);
                    waveArrows.push(eArr, bArr);
                }
            }
            eLine.geometry.setFromPoints(ePoints);
            bLine.geometry.setFromPoints(bPoints);
        }

        function animate() {
            requestAnimationFrame(animate);
            if (document.getElementById('sim-tab').classList.contains('active')) {
                time += 0.03;
                updateWaves();
                controls.update();
                renderer.render(scene, camera);
            }
        }

        window.onload = init;
    </script>
</body>
</html>